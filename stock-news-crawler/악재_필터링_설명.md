# 악재 필터링 시스템

## 🎯 문제점과 해결

### 이전 문제
```
제목: Chipotle Stock Tanks 19% On Lower Forecast and Sluggish Consumer Spending
결과: ✅ 호재로 분류 (잘못됨!)
```

**원인:**
- 단순 키워드 매칭만 사용
- "Stock", "Forecast" 같은 중립 단어도 점수 부여
- 악재 키워드가 4개뿐 (부고, 사망, 소송, 횡령)

### 현재 해결
```
제목: Chipotle Stock Tanks 19% On Lower Forecast and Sluggish Consumer Spending  
결과: ❌ 악재로 감지하여 제외 (정상!)
감지 키워드: "tanks", "sluggish", "lower forecast"
```

## 📋 악재 키워드 목록 (42개)

### 🔻 주가 급락
```
한글: 폭락, 급락, 하락
영문: tanks, plunges, crashes, tumbles
```

### 📉 실적 악화
```
한글: 적자, 손실, 부진, 실적 악화, 영업손실, 낮은 전망
영문: sluggish, weak, disappointing, misses, lower forecast
```

### 🏢 경영 문제
```
파산, 도산, 부도, 워크아웃
구조조정, 정리해고, 감원
```

### ⚖️ 법적 문제
```
소송, 횡령, 배임, 사기
기소, 구속, 압수수색, 고발
```

### 🚨 기타 악재
```
리콜, 결함, 사고
중단, 취소, 철회
부고, 사망, 별세
```

## 🔍 필터링 알고리즘

```python
# 1. 악재 키워드 체크 (우선)
if any(bad_keyword in text for bad_keyword in exclude_keywords):
    return "제외"  # 악재 감지

# 2. 호재 키워드 점수 계산
score = sum(호재_키워드_점수)

# 3. 최소 점수 체크
if score >= min_score:
    return "통과"  # 호재로 분류
else:
    return "제외"  # 점수 부족
```

**우선순위:** 악재 감지 > 호재 점수

## ✅ 테스트 결과

### 악재 뉴스 (모두 차단)
| 제목 | 감지 키워드 | 결과 |
|------|------------|------|
| Stock Tanks 19% | tanks, sluggish | ✅ 제외 |
| 영업손실 1조원 기록 | 영업손실 | ✅ 제외 |
| 구조조정 단행 | 구조조정 | ✅ 제외 |
| 리콜 사태로 폭락 | 리콜, 폭락 | ✅ 제외 |

### 호재 뉴스 (정상 통과)
| 제목 | 점수 | 결과 |
|------|------|------|
| AI 반도체 특허 150건 획득 | - | ✅ 통과 |
| HBM 수주 확대로 실적 호조 | 8.5점 | ✅ 통과 |

## 🛠️ 커스터마이징

### 악재 키워드 추가
`config.yaml` 파일 수정:

```yaml
filtering:
  exclude_keywords:
    - "폭락"
    - "급락"
    - "your_keyword"  # 여기에 추가
```

### 민감도 조절

**엄격하게 (악재 많이 차단):**
```yaml
exclude_keywords:
  - "하락"  # 추가
  - "감소"  # 추가
  - "둔화"  # 추가
```

**느슨하게 (일부 통과):**
```yaml
# "하락", "감소" 같은 중립적 단어 제거
# "폭락", "급락" 같은 강한 악재만 유지
```

## 📊 실전 예시

### Before (악재 필터링 전)
```
수집: 157건
필터링 통과: 15건 (악재 5건 포함 ❌)
```

### After (악재 필터링 후)
```
수집: 157건
악재 차단: 8건
필터링 통과: 10건 (순수 호재만 ✅)
```

## 💡 팁

### 1. 로그 확인
```bash
# 어떤 뉴스가 제외되었는지 확인
cat crawler.log | grep "제외"
```

### 2. 테스트
```bash
python test_negative_news.py
```

### 3. 키워드 검증
의심스러운 뉴스가 통과했다면:
1. `filtered_news.json` 확인
2. 해당 뉴스의 제목/요약에서 악재 키워드 찾기
3. `config.yaml`의 `exclude_keywords`에 추가

## 🎯 추천 설정

### 보수적 (안전)
```yaml
min_score: 5.0  # 높은 점수만
exclude_keywords: [많은 악재 키워드]  # 엄격한 필터
```

### 균형
```yaml
min_score: 3.0  # 보통 점수
exclude_keywords: [기본 악재 키워드]  # 현재 설정
```

### 공격적 (정보 수집)
```yaml
min_score: 2.0  # 낮은 점수도 허용
exclude_keywords: [핵심 악재만]  # 최소한의 필터
```

---

**버전**: v2.3.0  
**업데이트**: 2025-10-30  
**개선사항**: 악재 필터링 시스템 대폭 강화 (4개 → 42개)

